"use strict";(self["webpackChunkv2_htxt"]=self["webpackChunkv2_htxt"]||[]).push([[227],{8227:function(t,e,a){a.r(e),a.d(e,{default:function(){return D}});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"Spu"},[a("el-card",[a("card-three-select",{attrs:{disabled:t.isShowTable},on:{getShopId:t.getCategory}})],1),a("el-card",{staticClass:"box-card"},[a("keep-alive",[a(t.com,{tag:"component"})],1)],1)],1)},l=[],i=a(4665),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"SpuList"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",disabled:!t.sForm.category3Id},on:{click:function(e){return t.changeScene(1)}}},[t._v("添加SPU")]),a("el-table",{staticStyle:{width:"100%",margin:"15px 0"},attrs:{border:"",stripe:"",data:t.sTable.spuList,"empty-text":"暂无数据，请选择分类类型"}},t._l(5,(function(e,s){return a("el-table-column",{key:s,attrs:{prop:t.sTable.tableProp[s],label:t.sTable.tableLabel[s],width:t.sTable.tableWidth[s],align:0===s?"center":""},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row,i=e.$index;return["id"===t.sTable.tableProp[s]?a("span",[t._v(t._s(i+1))]):t._e(),"spuName"===t.sTable.tableProp[s]?a("span",[t._v(t._s(l.spuName))]):t._e(),"description"===t.sTable.tableProp[s]?a("span",[t._v(t._s(l.description))]):t._e(),"timer"===t.sTable.tableProp[s]?a("span",[t._v(t._s(l.timer))]):t._e(),"active"===t.sTable.tableProp[s]?a("div",[a("hin-button",{attrs:{type:"success",icon:"el-icon-plus",size:"mini",content:"添加sku"},on:{click:function(e){return t.changeScene(2,l)}}}),a("hin-button",{attrs:{type:"warning",icon:"el-icon-edit",size:"mini",content:"修改spu"},on:{click:function(e){return t.changeScene(1,l)}}}),a("hin-button",{attrs:{type:"info",icon:"el-icon-info",size:"mini",content:"查看当前spu的sku列表"},on:{click:function(e){return t.watchSkuList(l)}}}),a("el-popconfirm",{staticStyle:{"margin-left":"10px"},attrs:{"confirm-button-text":"确定","cancel-button-text":"取消",icon:"el-icon-info","icon-color":"red",title:"确定删除码？"},on:{confirm:function(e){return t.delSpuList(l)}}},[a("hin-button",{attrs:{slot:"reference",type:"danger",icon:"el-icon-delete",size:"mini",content:"删除spu"},slot:"reference"})],1),a("el-dialog",{attrs:{top:"8vh",title:t.rowdata.spuName+" 的Sku列表",visible:t.dialogTableVisible,"append-to-body":""},on:{"update:visible":function(e){t.dialogTableVisible=e},closed:t.closedDiolog}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.skuFromSpuList,border:""}},[a("el-table-column",{attrs:{prop:"skuName",label:"名称",width:"150"}}),a("el-table-column",{attrs:{prop:"price",label:"价格",width:"200"}}),a("el-table-column",{attrs:{prop:"weight",label:"重量"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间"}}),a("el-table-column",{attrs:{prop:"skuDefaultImg",label:"图片"},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.row;return[a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.skuDefaultImg,fit:"fit"}})]}}],null,!0)})],1)],1)],1):t._e()]}}],null,!0)})})),1),a("el-pagination",{staticStyle:{"margin-top":"20px","text-align":"center"},attrs:{"pager-count":7,layout:"total , prev , pager, next, jumper, ->, sizes","page-size":t.pagination.limit,"page-sizes":t.pagination.sizes,total:t.pagination.total,"current-page":t.pagination.page},on:{"current-change":t.currentChange,"size-change":t.sizeChange}})],1)},n=[],u={name:"SpuList",data(){return{dialogTableVisible:!1,rowdata:{},loading:!0}},mounted(){},methods:{...(0,i.OI)({CHANGE_S_TABLE:(t,e)=>t("spu/CHANGE_S_TABLE",e),CHANGE_C_FORM:(t,e)=>t("spu/CHANGE_S_FORM",e),CHANGE_PAGIN:(t,e)=>t("spu/CHANGE_PAGIN",e),CHANGE_SENCE:(t,e)=>t("spu/CHANGE_SENCE",e),CHANGE_IS_SHOWTABLE:(t,e)=>t("spu/CHANGE_IS_SHOWTABLE",e),CHANGE_SPU_IMAGE:(t,e)=>t("spu/CHANGE_SPU_IMAGE",e),CHANGE_SKUDATA:(t,e)=>t("spu/CHANGE_SKUDATA",e),CHANGE_SKUFROMSPULIST:(t,e)=>t("spu/CHANGE_SKUFROMSPULIST",e)}),...(0,i.nv)({getSpuDate:(t,e)=>t("spu/getSpuDate",e),getSpuById:(t,e)=>t("spu/getSpuById",e),getTrademarkList:(t,e)=>t("spu/getTrademarkList",e),spuImageList:(t,e)=>t("spu/spuImageList",e),baseSaleAttrList:(t,e)=>t("spu/baseSaleAttrList",e),deleteSpu:(t,e)=>t("spu/deleteSpu",e),skuImageList:(t,e)=>t("spu/skuImageList",e),skuSaleAttrList:(t,e)=>t("spu/skuSaleAttrList",e),skuAttrInfoList:(t,e)=>t("spu/skuAttrInfoList",e),skuFindBySpuId:(t,e)=>t("spu/skuFindBySpuId",e)}),currentChange(t=1){this.CHANGE_PAGIN({page:t}),this.getSpuDate({...this.pagination,...this.sForm})},sizeChange(t){this.CHANGE_PAGIN({limit:t,page:1}),this.getSpuDate({...this.pagination,...this.sForm})},changeScene(t,e){this.CHANGE_SENCE(t),this.CHANGE_IS_SHOWTABLE(!1),e&&(this.getSpuById(e.id),this.spuImageList(e.id)),1===t&&(this.getTrademarkList(),this.baseSaleAttrList()),2===t&&(this.skuImageList(e.id),this.skuSaleAttrList(e.id),this.skuAttrInfoList(this.sForm),this.CHANGE_SKUDATA({category3Id:e.category3Id,spuId:e.id,tmId:e.tmId,spuName:e.spuName}))},delSpuList(t){this.deleteSpu(t.id)},watchSkuList(t){this.dialogTableVisible=!0,this.rowdata=t,this.skuFindBySpuId(t.id).then((t=>{const e=setTimeout((()=>{this.loading=!1,clearTimeout(e)}),500)}))},closedDiolog(){this.CHANGE_SKUFROMSPULIST([]),this.loading=!0}},computed:{...(0,i.rn)({sTable:t=>t.spu.sTable,sForm:t=>t.spu.sForm,pagination:t=>t.spu.pagination,skuFromSpuList:t=>t.spu.skuFromSpuList})}},o=u,p=a(1001),d=(0,p.Z)(o,r,n,!1,null,"41d00ed5",null),c=d.exports,m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"AddSpu"},[a("el-form",{ref:"form",attrs:{"label-width":"80px",model:t.spuData},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"SPU名称"}},[a("el-input",{attrs:{placeholder:"SPU名称"},model:{value:t.spuData.spuName,callback:function(e){t.$set(t.spuData,"spuName",e)},expression:"spuData.spuName"}})],1),a("el-form-item",{attrs:{label:"品牌"}},[a("el-select",{attrs:{placeholder:"请选择活动区域"},model:{value:t.spuData.tmId,callback:function(e){t.$set(t.spuData,"tmId",e)},expression:"spuData.tmId"}},t._l(t.tradmarkData,(function(t,e){return a("el-option",{key:e,attrs:{label:t.tmName,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"SPU描述"}},[a("el-input",{attrs:{type:"textarea",rows:"4",placeholder:"SPU描述"},model:{value:t.spuData.description,callback:function(e){t.$set(t.spuData,"description",e)},expression:"spuData.description"}})],1),a("el-form-item",{attrs:{label:"SPU图片"}},[a("el-upload",{attrs:{action:"/dev-api/admin/product/fileUpload","list-type":"picture-card","on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove,"file-list":t.spuImage,"on-success":t.updateSuccess}},[a("i",{staticClass:"el-icon-plus"})]),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1),a("el-form-item",{attrs:{label:"销售属性"}},[a("el-select",{attrs:{placeholder:"还有"+t.filsale.length+"项未选"},model:{value:t.attrSelId,callback:function(e){t.attrSelId=e},expression:"attrSelId"}},t._l(t.filsale,(function(t,e){return a("el-option",{key:e+t.name,attrs:{label:t.name,value:t.id}})})),1),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",disabled:!t.attrSelId},on:{click:t.addAttrHandle}},[t._v("添加销售属性")]),a("el-table",{attrs:{border:"",data:t.spuData.spuSaleAttrList}},t._l(t.addTab.tableProp,(function(e,s){return a("el-table-column",{key:e+s,attrs:{label:t.addTab.tableLabel[s],align:"id"===e?"center":"",prop:e,width:t.addTab.tableWidth[s]},scopedSlots:t._u([{key:"default",fn:function(s){var l=s.row,i=s.$index;return["id"===e?a("span",[t._v(t._s(i+1))]):t._e(),"saleAttrName"===e?a("span",[t._v(t._s(l.saleAttrName))]):t._e(),"spuSaleAttrValueList"===e?a("span",[t._l(l.spuSaleAttrValueList,(function(e,s){return a("el-tag",{directives:[{name:"show",rawName:"v-show",value:!e.isChecked,expression:"!tag.isChecked"}],key:e.saleAttrValueName+s,attrs:{closable:"","disable-transitions":!1},on:{close:function(e){return t.handleClose(s,l)}}},[t._v(t._s(e.saleAttrValueName))])})),l.inputVisible?a("el-input",{ref:"saveTagInput",refInFor:!0,staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(e){return t.handleInputConfirm(l)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm(l)}},model:{value:l.saleAttrValueName,callback:function(e){t.$set(l,"saleAttrValueName",e)},expression:"row.saleAttrValueName"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(e){return t.addSelectAttrVaule(l)}}},[t._v("+ 添 加")])],2):t._e(),"timer"===e?a("span",[t._v(t._s(l.timer))]):t._e(),"active"===e?a("span",[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(e){return t.delAttrHandle(i)}}},[t._v("删 除")])],1):t._e()]}}],null,!0)})})),1)],1),a("el-form-item",[a("el-button",{on:{click:t.ok}},[t._v("确 定")]),a("el-button",{on:{click:t.back}},[t._v("返 回")])],1)],1)],1)},S=[],A={name:"AddSpu",data(){return{dialogImageUrl:"",dialogVisible:!1,addTab:{tableLabel:["序号","属性名","属性值列表","日期","操作"],tableWidth:[100,280,"",230,300],tableProp:["id","saleAttrName","spuSaleAttrValueList","timer","active"]},attrSelId:""}},methods:{...(0,i.OI)({CHANGE_SENCE:(t,e)=>t("spu/CHANGE_SENCE",e),CHANGE_IS_SHOWTABLE:(t,e)=>t("spu/CHANGE_IS_SHOWTABLE",e),RESET_ADD_DATA:(t,e)=>t("spu/RESET_ADD_DATA",e),SET_SPUSALEATTRLIST:(t,e)=>t("spu/SET_SPUSALEATTRLIST",e),DEL_SPUSALEATTRLIST:(t,e)=>t("spu/DEL_SPUSALEATTRLIST",e),CHANGE_SPU_IMAGE:(t,e)=>t("spu/CHANGE_SPU_IMAGE",e)}),...(0,i.nv)({saveOrUpdateSpu:(t,e)=>t("spu/saveOrUpdateSpu",e)}),ok(){this.saveOrUpdateSpu(this.spuData),console.log(this.spuData)},back(){this.CHANGE_SENCE(0),this.CHANGE_IS_SHOWTABLE(!0),this.RESET_ADD_DATA()},handleRemove(t,e){this.CHANGE_SPU_IMAGE(e)},handlePictureCardPreview(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},updateSuccess(t,e,a){this.CHANGE_SPU_IMAGE(a)},addAttrHandle(){const{id:t,name:e}=this.filsale.find((t=>t.id===this.attrSelId)),a=this.timer([{baseSaleAttrId:this.attrSelId,id:0,isChecked:!1,saleAttrName:e,spuSaleAttrValueList:[],spuId:t||""}]);this.SET_SPUSALEATTRLIST(a[0]),this.attrSelId=""},delAttrHandle(t){this.DEL_SPUSALEATTRLIST(t)},addSelectAttrVaule(t){this.$set(t,"inputVisible",!0),this.$set(t,"saleAttrValueName",""),this.$nextTick((t=>{this.$refs.saveTagInput[0].$refs.input.focus()}))},handleInputConfirm(t){t.inputVisible=!1;const{baseSaleAttrId:e,saleAttrValueName:a,saleAttrName:s,spuId:l}=t,i=t.spuSaleAttrValueList.every((t=>t.saleAttrValueName!==a));a.trim()&&i&&t.spuSaleAttrValueList.push({saleAttrName:s,baseSaleAttrId:e,saleAttrValueName:a,isChecked:!1,spuId:l})},handleClose(t,e){e.spuSaleAttrValueList.splice(t,1)}},computed:{...(0,i.rn)({spuData:t=>t.spu.spuData,tradmarkData:t=>t.spu.tradmarkData,spuImage:t=>t.spu.spuImage,saleAttrList:t=>t.spu.saleAttrList}),...(0,i.Se)(["filsale","timer"])},watch:{}},b=A,_=(0,p.Z)(b,m,S,!1,null,"2cb25027",null),h=_.exports,f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"AddSku"},[a("el-form",{ref:"allForm",attrs:{"label-width":"80px",data:t.skuData},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"SPU名称"}},[a("span",[t._v(t._s(t.skuData.spuName))])]),a("el-form-item",{attrs:{label:"SKU名称",prop:"skuName"}},[a("el-input",{attrs:{placeholder:"SKU名称"},model:{value:t.skuData.skuName,callback:function(e){t.$set(t.skuData,"skuName",e)},expression:"skuData.skuName"}})],1),a("el-form-item",{attrs:{label:"价格(元)",prop:"price"}},[a("el-input",{attrs:{placeholder:"价格(元)",type:"number"},model:{value:t.skuData.price,callback:function(e){t.$set(t.skuData,"price",e)},expression:"skuData.price"}})],1),a("el-form-item",{attrs:{label:"重量(千斤)",prop:"weight"}},[a("el-input",{attrs:{placeholder:"重量(千斤)",type:"number"},model:{value:t.skuData.weight,callback:function(e){t.$set(t.skuData,"weight",e)},expression:"skuData.weight"}})],1),a("el-form-item",{attrs:{label:"规则描述",prop:"skuDesc"}},[a("el-input",{attrs:{type:"textarea",rows:"5",placeholder:"规则描述"},model:{value:t.skuData.skuDesc,callback:function(e){t.$set(t.skuData,"skuDesc",e)},expression:"skuData.skuDesc"}})],1),a("el-form-item",{attrs:{label:"平台属性"}},[a("el-form",{ref:"ptForm",attrs:{inline:"","label-width":"80px",data:t.skuData}},t._l(t.attrInfoList,(function(e,s){return a("el-form-item",{key:e.attrName+s,attrs:{label:e.attrName}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.idAndAttrId,callback:function(a){t.$set(e,"idAndAttrId",a)},expression:"attr.idAndAttrId"}},t._l(e.attrValueList,(function(t,e){return a("el-option",{key:t.valueName+e,attrs:{label:t.valueName,value:t.id+":"+t.attrId}})})),1)],1)})),1)],1),a("el-form-item",{attrs:{label:"销售属性"}},[a("el-form",{ref:"colorForm",attrs:{inline:"","label-width":"80px"}},t._l(t.skuSaleAttrList,(function(e,s){return a("el-form-item",{key:e.saleAttrName+s,attrs:{label:e.saleAttrName}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.idAndValueId,callback:function(a){t.$set(e,"idAndValueId",a)},expression:"attr.idAndValueId"}},t._l(e.spuSaleAttrValueList,(function(t,s){return a("el-option",{key:t.saleAttrName+s,attrs:{label:t.saleAttrValueName,value:e.id+":"+t.id}})})),1)],1)})),1)],1),a("el-form-item",{attrs:{label:"图片列表"}},[a("el-table",{ref:"imgTabel",staticStyle:{width:"100%"},attrs:{"tooltip-effect":"dark",border:"",data:t.kTable.spuList},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"80"}}),t._l(t.kTable.tableProp,(function(e,s){return a("el-table-column",{key:e+s,attrs:{label:t.kTable.tableLabel[s],width:t.kTable.tableWidth[s],prop:e},scopedSlots:t._u([{key:"default",fn:function(s){var l=s.row;return["imgUrl"===e?a("el-image",{staticStyle:{width:"100px"},attrs:{src:l.imgUrl}}):t._e(),"imgName"===e?a("span",[t._v(t._s(l.imgName))]):t._e(),"active"===e?a("div",[0===l.isDefault?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.defaultHanlde(l,1)}}},[t._v("设为默认")]):a("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.defaultHanlde(l)}}},[t._v("默认")])],1):t._e()]}}],null,!0)})}))],2)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.ok}},[t._v("确 定")]),a("el-button",{on:{click:t.back}},[t._v("返 回")])],1)],1)],1)},k=[],g={name:"AddSku",date(){return{imageList:[]}},methods:{...(0,i.OI)({CHANGE_SENCE:(t,e)=>t("spu/CHANGE_SENCE",e),CHANGE_IS_SHOWTABLE:(t,e)=>t("spu/CHANGE_IS_SHOWTABLE",e),RESET_SKUDATA:(t,e)=>t("spu/RESET_SKUDATA",e),CHANGE_SKUDATA:(t,e)=>t("spu/CHANGE_SKUDATA",e),RESET_ADD_DATA:(t,e)=>t("spu/RESET_ADD_DATA",e)}),...(0,i.nv)({skuSaveSkuInfo:(t,e)=>t("spu/skuSaveSkuInfo",e)}),ok(){this.skuSaveSkuInfo(this.imageList)},back(){this.RESET_SKUDATA(),this.RESET_ADD_DATA(),this.CHANGE_SENCE(0),this.CHANGE_IS_SHOWTABLE(!0)},handleSelectionChange(t){console.log(t),this.imageList=t},defaultHanlde(t,e){this.kTable.spuList.forEach((t=>{t.isDefault=0})),e&&(t.isDefault=e),this.CHANGE_SKUDATA({skuDefaultImg:t.imgUrl}),console.log(t)}},computed:{...(0,i.rn)({kTable:t=>t.spu.kTable,skuData:t=>t.spu.skuData,attrInfoList:t=>t.spu.attrInfoList,skuSaleAttrList:t=>t.spu.skuSaleAttrList})}},E=g,T=(0,p.Z)(E,f,k,!1,null,"31a04204",null),N=T.exports,I={name:"SpuIndex",components:{SpuList:c,AddSpu:h,AddSku:N},data(){return{}},methods:{...(0,i.OI)({CHANGE_S_TABLE:(t,e)=>t("spu/CHANGE_S_TABLE",e),CHANGE_S_FORM:(t,e)=>t("spu/CHANGE_S_FORM",e),RESET_STATE:(t,e)=>t("spu/RESET_STATE")}),...(0,i.nv)({getSpuDate:(t,e)=>t("spu/getSpuDate",e)}),getCategory(t){this.CHANGE_S_FORM({...t}),this.getSpuDate({...this.pagination,...this.sForm})}},computed:{...(0,i.rn)({sTable:t=>t.spu.sTable,sForm:t=>t.spu.sForm,pagination:t=>t.spu.pagination,scene:t=>t.spu.scene,isShowTable:t=>t.spu.isShowTable}),com(){let t=null;switch(this.scene){case 0:t="SpuList";break;case 1:t="AddSpu";break;case 2:t="AddSku";break}return t}},beforeDestroy(){this.RESET_STATE()}},v=I,L=(0,p.Z)(v,s,l,!1,null,"5e3297f3",null),D=L.exports}}]);
//# sourceMappingURL=227.010de13b.js.map