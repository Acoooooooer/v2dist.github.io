"use strict";(self["webpackChunkv2_htxt"]=self["webpackChunkv2_htxt"]||[]).push([[729],{9729:function(t,e,a){a.r(e),a.d(e,{default:function(){return u}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h3",[t._v("添加品牌")]),a("div",{staticClass:"add-pinpai"},[a("div",{staticClass:"footer"},[a("el-form",{ref:"tmform",staticStyle:{width:"80%"},attrs:{model:t.tmform,rules:t.rules}},[a("form-trade",{attrs:{tmform:t.tmform,handleAvatarSuccess:t.handleAvatarSuccess,beforeAvatarUpload:t.beforeAvatarUpload},on:{changeTmName:t.changeTmName,claerLogoUrl:t.claerLogoUrl}})],1),a("el-button",{on:{click:t.back}},[t._v("返 回")]),a("el-button",{attrs:{type:"primary"},on:{click:t.OK}},[t._v("确 定")])],1)])])},o=[],s=a(9165),m=a(2742),i={name:"AddItem",props:["a"],mixins:[s.Z],components:{FormTrade:m.Z},data(){return{timeout:null}},methods:{back(){this.$router.push("/trademark")},changeTmName(t){this.tmform.tmName=t}},watch:{tmform:{deep:!0,handler:function(){clearTimeout(this.timeout),this.timeout=setTimeout((()=>{localStorage.tmform=JSON.stringify(this.tmform)}),800)}}},beforeRouteEnter(t,e,a){a((t=>{t.tmform=localStorage.tmform?JSON.parse(localStorage.tmform):t.tmform}))}},l=i,n=a(1001),c=(0,n.Z)(l,r,o,!1,null,"397b004a",null),u=c.exports},2742:function(t,e,a){a.d(e,{Z:function(){return n}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form-item",{attrs:{label:"品牌名称","label-width":"'100px'",prop:"tmName"}},[a("el-input",{staticClass:"inp",attrs:{autocomplete:"off"},model:{value:t.tmName,callback:function(e){t.tmName=e},expression:"tmName"}})],1),a("el-form-item",{attrs:{label:"品牌LOGO","label-width":"'100px'",prop:"logoUrl"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/dev-api/admin/product/fileUpload","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload,"list-type":"picture"}},[a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" 只能上传jpg/png文件, 且不超过500kb ")]),t.tmform.logoUrl?a("img",{staticClass:"avatar",attrs:{src:t.tmform.logoUrl},on:{click:function(t){t.stopPropagation()}}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),a("i",{directives:[{name:"show",rawName:"v-show",value:t.tmform.logoUrl,expression:"tmform.logoUrl"}],staticClass:"el-icon-delete position-icon",on:{click:function(e){return e.stopPropagation(),t.$emit("claerLogoUrl")}}})])],1),a("el-form-item")],1)},o=[],s={name:"FormTrade",props:["tmform","handleAvatarSuccess","beforeAvatarUpload"],data(){return{tmName:""}},watch:{tmform:{immediate:!0,handler:function(){this.tmName=this.tmform.tmName}},tmName(){this.$emit("changeTmName",this.tmName)}}},m=s,i=a(1001),l=(0,i.Z)(m,r,o,!1,null,"5fdb90a0",null),n=l.exports},9165:function(t,e){e["Z"]={data(){return{imageUrl:"",tmform:{tmName:"",logoUrl:""},rules:{tmName:[{required:!0,message:"请输入名称",tigger:"blur"},{min:3,max:12,message:"长度在3 到 12 之间",tigger:"change"}],logoUrl:[{required:!0,message:"请上传logo",tigger:"change"}]}}},methods:{handleAvatarSuccess(t,e){200===t.code?(this.tmform.logoUrl=t.data,this.$refs.tmform.validate()):this.$message({message:"上传失败",type:"error"})},beforeAvatarUpload(t){const e="image/jpeg"===t.type,a=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&a},async OK(){this.$refs.tmform.validate((async(t,e)=>{if(!t)return!1;{const t=await this.$apis.trademark.reqSaveOrUpdate(this.tmform);console.log(t),200===t.code?(this.$message({message:this.tmform.id?"修改成功":"保存成功",type:"success"}),"/trademark/additem"===this.$route.path?this.$router.push("/trademark"):"/trademark"===this.$route.path&&(this.visible=!1,this.getPageList())):this.$message({message:this.tmform.id?"修改失败":"保存失败",type:"error"})}}))},changeTmName(t){this.tmform.tmName=t},claerLogoUrl(){this.tmform.logoUrl=""}}}}}]);
//# sourceMappingURL=729.84e0599d.js.map