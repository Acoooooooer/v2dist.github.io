"use strict";(self["webpackChunkv2_htxt"]=self["webpackChunkv2_htxt"]||[]).push([[756],{42756:function(t,e,a){a.r(e),a.d(e,{default:function(){return f}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"AttrIdex"},[a("el-card",[a("card-three-select",{attrs:{disabled:t.isShowTable},on:{getShopId:t.getShopId}})],1),a("el-card",[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.isShowTable,expression:"!isShowTable"}],key:"1"},[a("el-form",{ref:"attrInfoadd",attrs:{inline:!0,model:t.attrInfo,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"属性名",prop:"attrName"}},[a("el-input",{attrs:{placeholder:"请输入属性名"},model:{value:t.attrInfo.attrName,callback:function(e){t.$set(t.attrInfo,"attrName",e)},expression:"attrInfo.attrName"}},[t._v("++")])],1)],1),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",disabled:!t.attrInfo.attrName},on:{click:t.add}},[t._v("添加属性值")]),a("el-button",{on:{click:t.back}},[t._v("取 消")]),a("el-form",{ref:"attrInfotab",attrs:{model:t.attrInfo},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{prop:"attrValueList"}},[a("el-table",{staticStyle:{margin:"20px 0"},attrs:{border:"",data:t.attrInfo.attrValueList,stripe:""}},t._l(4,(function(e,r){return a("el-table-column",{key:""+r,attrs:{prop:t.cTabadd.tableProp[r],label:t.cTabadd.tableLabel[r],width:t.cTabadd.tableWidth[r],align:0===r?"center":""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row,i=e.$index;return["id"===t.cTabadd.tableProp[r]?a("span",[t._v(t._s(i+1))]):t._e(),"attrName"===t.cTabadd.tableProp[r]?a("span",[n.flag?t._e():a("span",{staticClass:"span_vlaue",on:{click:function(t){n.flag=!0}}},[t._v(t._s(n.valueName))]),n.flag?a("el-input",{directives:[{name:"focus",rawName:"v-focus",value:n,expression:"row"}],ref:"inp"+i,refInFor:!0,attrs:{placeholder:"请输入属性值名称",size:"mini"},on:{blur:function(e){return t.blur(n)}},nativeOn:{keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;n.flag=!1}},model:{value:n.valueName,callback:function(e){t.$set(n,"valueName",e)},expression:"row.valueName"}}):t._e()],1):t._e(),"timer"===t.cTabadd.tableProp[r]?a("span",[t._v(t._s(n.timer))]):t._e(),"active"===t.cTabadd.tableProp[r]?a("div",[a("el-popconfirm",{attrs:{"confirm-button-text":"好的","cancel-button-text":"不用了",icon:"el-icon-info","icon-color":"red",title:"确定删除 "+n.valueName+" 吗?"},on:{confirm:function(e){return t.delvalue(i)}}},[a("el-button",{attrs:{slot:"reference",type:"danger",icon:"el-icon-delete",size:"mini"},slot:"reference"},[t._v("删除")])],1)],1):t._e()]}}],null,!0)})})),1),a("el-button",{attrs:{type:"primary",disabled:!t.attrInfo.attrValueList.length},on:{click:t.saveOnce}},[t._v("保存")]),a("el-button",{on:{click:t.back}},[t._v("取消")]),t._v(" "+t._s(t.attrInfo.attrValueList.length)+"条 ")],1)],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowTable,expression:"isShowTable"}],key:"2"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",disabled:!t.cForm.category3Id},on:{click:t.attrInfoHandle}},[t._v("添加属性")]),a("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{"empty-text":"暂无数据，请选择分类类型",border:"",data:t.cTable.attrList,stripe:""}},t._l(5,(function(e,r){return a("el-table-column",{key:""+e.attrName+r,attrs:{prop:t.cTable.tableProp[r],label:t.cTable.tableLabel[r],width:t.cTable.tableWidth[r],align:0===r?"center":""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row,i=e.$index;return["id"===t.cTable.tableProp[r]?a("span",[t._v(t._s(i+1))]):t._e(),"attrName"===t.cTable.tableProp[r]?a("span",[t._v(t._s(n.attrName))]):t._e(),"attrValueList"===t.cTable.tableProp[r]?a("div",t._l(n.attrValueList,(function(e,r){return a("el-tag",{key:""+e.valueName+r,staticStyle:{"margin-left":"10px"},attrs:{type:t._f("type")(t.cTable.typeList)}},[t._v(t._s(e.valueName))])})),1):t._e(),"timer"===t.cTable.tableProp[r]?a("span",[t._v(t._s(n.timer))]):t._e(),"active"===t.cTable.tableProp[r]?a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(e){return t.changeAttr(n)}}},[t._v("修改")]),a("el-popconfirm",{attrs:{"confirm-button-text":"好的","cancel-button-text":"不用了",icon:"el-icon-info","icon-color":"red",title:"确定删除 "+n.attrName+" 吗?"},on:{confirm:function(e){return t.deleteAttr(n)}}},[a("el-button",{staticStyle:{"margin-left":"15px"},attrs:{slot:"reference",type:"danger",icon:"el-icon-delete",size:"mini"},slot:"reference"},[t._v("删除")])],1)],1):t._e()]}}],null,!0)})})),1)],1)])],1)},n=[],i=a(16198),l=a(93019),o=(a(78975),a(21249),a(73210),a(41539),a(40561),a(57327),{name:"AttrIdex",data:function(){return{cForm:{category1Id:"",category2Id:"",category3Id:""},cTable:{tableLabel:["序号","属性值名称","属性值列表","日期","操作"],tableWidth:[100,280,"",200,300],tableProp:["id","attrName","attrValueList","timer","active"],typeList:["success","info","warning","danger"],attrList:[]},cTabadd:{tableLabel:["序号","属性值名称","日期","操作"],tableWidth:[100,"",200,300],tableProp:["id","attrName","timer","active"]},attrInfo:{attrName:"",attrValueList:[],categoryId:0,categoryLevel:3},isShowTable:!0}},directives:{focus:{inserted:function(t,e,a){t.children[0].focus(),a.context.isFocus=!1}}},methods:{getShopId:function(t){this.cForm=(0,l.Z)({},t),this.getAttrList()},getAttrList:function(){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$apis.attr.getAttrList(t.cForm);case 2:a=e.sent,200===a.code&&(t.cTable.attrList=a.data.map((function(e,a){return e.timer=t.$timer(t.$timer().valueOf()-parseInt(1e9*Math.random())).format("L LTS"),e})));case 4:case"end":return e.stop()}}),e)})))()},attrInfoHandle:function(){this.isShowTable=!1,this.$refs.attrInfoadd.resetFields(),this.$refs.attrInfotab.resetFields(),this.attrInfo.categoryId=this.cForm.category3Id},changeAttr:function(t){this.isShowTable=!1,this.isFocus=!0,this.attrInfo=this.$lds.cloneDeepWith(t,(function(e,a,r){"number"===typeof a&&(e.timer=t.timer,e.flag=!1)}))},add:function(){this.attrInfo.attrValueList.push({attrId:this.attrInfo.id,timer:this.$timer().format("L LTS"),flag:!0,valueName:""})},back:function(){var t=this;this.isShowTable=!0,this.$nextTick((function(){t.$message.closeAll()}))},blur:function(t){if(t.valueName.trim()){var e=this.attrInfo.attrValueList.some((function(e){return t!==e&&e.valueName===t.valueName}));e?this.$message("不能重复"):t.flag=!1}else this.$message("不能为空")},delvalue:function(t){var e=this;this.attrInfo.attrValueList.splice(t,1),this.$nextTick((function(){e.$message.closeAll()}))},saveOnce:function(){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.attrInfo.attrValueList=t.attrInfo.attrValueList.filter((function(t){return t.valueName.trim()})),e.next=3,t.$apis.attr.saveAttrInfo(t.attrInfo);case 3:a=e.sent,200===a.code&&a.ok&&(t.getAttrList(),t.isShowTable=!0,t.$nextTick((function(){t.$message.closeAll(),t.$message({message:"成功",type:"success"})})));case 5:case"end":return e.stop()}}),e)})))()},deleteAttr:function(t){var e=this;return(0,i.Z)(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.$apis.attr.deleteAttr(t.id);case 2:r=a.sent,console.log(r),200===r.code&&r.ok&&e.getAttrList();case 5:case"end":return a.stop()}}),a)})))()}},filters:{type:function(t){return t[parseInt(5*Math.random())]}}}),s=o,c=a(1001),u=(0,c.Z)(s,r,n,!1,null,"eff96e86",null),f=u.exports}}]);
//# sourceMappingURL=756-legacy.5cd44112.js.map