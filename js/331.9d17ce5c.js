"use strict";(self["webpackChunkv2_htxt"]=self["webpackChunkv2_htxt"]||[]).push([[331],{2742:function(t,e,a){a.d(e,{Z:function(){return m}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form-item",{attrs:{label:"品牌名称","label-width":"'100px'",prop:"tmName"}},[a("el-input",{staticClass:"inp",attrs:{autocomplete:"off"},model:{value:t.tmName,callback:function(e){t.tmName=e},expression:"tmName"}})],1),a("el-form-item",{attrs:{label:"品牌LOGO","label-width":"'100px'",prop:"logoUrl"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/dev-api/admin/product/fileUpload","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload,"list-type":"picture"}},[a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" 只能上传jpg/png文件, 且不超过500kb ")]),t.tmform.logoUrl?a("img",{staticClass:"avatar",attrs:{src:t.tmform.logoUrl},on:{click:function(t){t.stopPropagation()}}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),a("i",{directives:[{name:"show",rawName:"v-show",value:t.tmform.logoUrl,expression:"tmform.logoUrl"}],staticClass:"el-icon-delete position-icon",on:{click:function(e){return e.stopPropagation(),t.$emit("claerLogoUrl")}}})])],1),a("el-form-item")],1)},s=[],i={name:"FormTrade",props:["tmform","handleAvatarSuccess","beforeAvatarUpload"],data(){return{tmName:""}},watch:{tmform:{immediate:!0,handler:function(){this.tmName=this.tmform.tmName}},tmName(){this.$emit("changeTmName",this.tmName)}}},o=i,l=a(1001),n=(0,l.Z)(o,r,s,!1,null,"5fdb90a0",null),m=n.exports},3331:function(t,e,a){a.r(e),a.d(e,{default:function(){return d}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"TradeMarkIdex"},[t.$store.state.trademark.isShow?[a("router-view")]:a("div",[a("el-button",{staticStyle:{margin:"10px 0"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.showAddTbale}},[t._v("添加")]),a("el-dialog",{attrs:{title:"修改品牌",visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[a("el-form",{ref:"tmform",staticStyle:{width:"80%"},attrs:{model:t.tmform,rules:t.rules}},[a("form-trade",{attrs:{tmform:t.tmform,handleAvatarSuccess:t.handleAvatarSuccess,beforeAvatarUpload:t.beforeAvatarUpload},on:{changeTmName:t.changeTmName,claerLogoUrl:t.claerLogoUrl}})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.OK}},[t._v("确 定")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,stripe:"",lazy:"",border:""}},[a("el-table-column",{attrs:{prop:"id",label:"序号",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.$index;return[a("span",[t._v(t._s(r+1+(t.page-1)*t.limit))])]}}])}),a("el-table-column",{attrs:{prop:"tmName",label:"品牌名称","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"logoUrl",label:"品牌LOGO"},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.row,r=t.$index;return[a("el-image",[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e.logoUrl?a("img",{key:r,staticClass:"logo_url",attrs:{src:e.logoUrl,alt:"err"}}):a("span",{staticClass:"el-icon-picture-outline"})])])]}}])}),a("el-table-column",{attrs:{prop:"timer",label:"日期"}}),a("el-table-column",{attrs:{prop:"prop",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[a("el-button",{attrs:{type:"warning",icon:"el-icon-edit",size:"mini"},on:{click:function(e){return t.undateTradeMark(r)}}},[t._v("修改")]),a("el-button",{staticClass:"delete",attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(e){return t.del(r)}}},[t._v("删除")])]}}])})],1),a("el-pagination",{staticStyle:{"margin-top":"20px","text-align":"center"},attrs:{"current-page":t.page,total:t.total,"page-size":t.limit,"pager-count":7,"page-sizes":[5,8,12],layout:"total , prev , pager, next, jumper,->,sizes"},on:{"size-change":t.sizeChange,"current-change":t.getPageList}})],1)],2)},s=[],i=a(9165),o=a(2742),l={name:"TradeMarkIdex",mixins:[i.Z],components:{FormTrade:o.Z},data(){return{page:1,limit:8,total:0,list:[],visible:!1}},methods:{async getPageList(t=this.page){this.page=t;const{page:e,limit:a,$timer:r}=this,s=await this.$apis.trademark.reqTradeMarkList(e,a);if(200===s.code){const{records:t,total:e}=s.data;this.list=t.map(((t,e)=>(t.timer=r(r().valueOf()-parseInt(1e9*Math.random())).format("L LTS"),t.tmName.includes("硅")&&(t.tmName="这是一个名字",t.logoUrl="http://47.93.148.192:8080/group1/M00/05/42/rBHu8mIz4dGATw5xAAZVHSssuyo174.jpg"),t))),this.total=e}},sizeChange(t){this.limit=t,this.getPageList()},showAddTbale(){this.$router.push("/trademark/additem")},undateTradeMark(t){this.tmform={...t},this.visible=!0},del(t){this.$confirm("是否删除该列?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const e=await this.$apis.trademark.resDelete(t.id);this.$message({type:200===e.code?"success":"error",message:200===e.code?"删除成功!":"删除失败"}),200===e.code&&this.getPageList(1===this.list.length&&this.page>1?this.page-1:this.page)})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))}},mounted(){this.getPageList()}},n=l,m=a(1001),c=(0,m.Z)(n,r,s,!1,null,"78b750b7",null),d=c.exports},9165:function(t,e){e["Z"]={data(){return{imageUrl:"",tmform:{tmName:"",logoUrl:""},rules:{tmName:[{required:!0,message:"请输入名称",tigger:"blur"},{min:3,max:12,message:"长度在3 到 12 之间",tigger:"change"}],logoUrl:[{required:!0,message:"请上传logo",tigger:"change"}]}}},methods:{handleAvatarSuccess(t,e){200===t.code?(this.tmform.logoUrl=t.data,this.$refs.tmform.validate()):this.$message({message:"上传失败",type:"error"})},beforeAvatarUpload(t){const e="image/jpeg"===t.type,a=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&a},async OK(){this.$refs.tmform.validate((async(t,e)=>{if(!t)return!1;{const t=await this.$apis.trademark.reqSaveOrUpdate(this.tmform);console.log(t),200===t.code?(this.$message({message:this.tmform.id?"修改成功":"保存成功",type:"success"}),"/trademark/additem"===this.$route.path?this.$router.push("/trademark"):"/trademark"===this.$route.path&&(this.visible=!1,this.getPageList())):this.$message({message:this.tmform.id?"修改失败":"保存失败",type:"error"})}}))},changeTmName(t){this.tmform.tmName=t},claerLogoUrl(){this.tmform.logoUrl=""}}}}}]);
//# sourceMappingURL=331.9d17ce5c.js.map